import os
import zipfile

def zip_oldest_folder(directory, output_zip):
    if not os.path.isdir(directory):
        return
    
    subdirs = [os.path.join(directory, d) for d in os.listdir(directory) if os.path.isdir(os.path.join(directory, d))]
    oldest_folder = min(subdirs, key=os.path.getctime)
    
    if len(subdirs) == 2:
        with zipfile.ZipFile(output_zip, 'w', zipfile.ZIP_DEFLATED) as zipf:
            for root, _, files in os.walk(oldest_folder):
                for file in files:
                    file_path = os.path.join(root, file)
                    arcname = os.path.relpath(file_path, start=os.path.dirname(directory))
                    zipf.write(file_path, arcname)
    else:
        return

# Example usage:
directory_to_check = "C:\\Users\\rvm85\\OneDrive - AP Hogeschool Antwerpen\\Documenten\\rasp pico\\ProjectFolder\\Malware\\ComponentScript\\"  # Replace with your directory path
output_zip_file = "result.zip"
zip_oldest_folder(directory_to_check, output_zip_file)
