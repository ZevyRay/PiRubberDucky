import subprocess
import sys
from datetime import datetime
import time

try:
    import pyscreeze
    import pyautogui
except:
    # pip install --upgrade pillow pyscreeze
    subprocess.check_call([sys.executable, "-m", "pip", "install", "--upgrade", "pillow", "pyscreeze"])
    subprocess.check_call([sys.executable, "-m", "pip", "install", "pyautogui"])
    import pyscreeze
    import pyautogui

def take_screenshot():
    timestamp = datetime.now().strftime("%Y-%m-%d_%H-%M-%S")
    filename = f"Screenlog_{timestamp}.png"
    screenshot = pyautogui.screenshot()
    screenshot.save(filename)
    
while True:
    take_screenshot()
    time.sleep(10)